<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0"
		/>
		<title>Mac OS System 7.5 Replica</title>
		<style>
			/* Chicago font fallback (use system fonts for web compat) */
			@font-face {
				font-family: 'Chicago';
				src: local('Monaco'), local('Courier New'), monospace;
			}
			body {
				margin: 0;
				padding: 0;
				font-family: 'Chicago', monospace;
				background: #c0c0c0;
				overflow: hidden;
				user-select: none;
				cursor: default;
			}
			#desktop {
				position: absolute;
				top: 20px;
				left: 0;
				right: 0;
				bottom: 0;
				background: #e0e0e0
					repeating-linear-gradient(
						45deg,
						transparent 0 2px,
						rgba(0, 0, 0, 0.1) 2px 4px
					);
			}
			#menubar {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				height: 20px;
				background: #c0c0c0;
				border-bottom: 1px solid #000;
				display: flex;
				align-items: center;
				padding: 0 5px;
				font-size: 12px;
				z-index: 1000;
			}
			.menu {
				margin-right: 10px;
				cursor: pointer;
			}
			.menu:hover {
				background: #000;
				color: #fff;
			}
			.dropdown {
				position: absolute;
				top: 20px;
				background: #e0e0e0;
				border: 1px solid #000;
				box-shadow: 2px 2px 0 #808080;
				display: none;
			}
			.dropdown div {
				padding: 2px 10px;
				cursor: pointer;
			}
			.dropdown div:hover {
				background: #000;
				color: #fff;
			}
			.icon {
				position: absolute;
				width: 50px;
				height: 50px;
				background: #fff;
				border: 1px solid #000;
				text-align: center;
				padding: 5px;
				cursor: pointer;
			}
			.icon.selected {
				background: #000;
				color: #fff;
			}
			.window {
				position: absolute;
				background: #e0e0e0;
				border: 1px solid #000;
				box-shadow: 2px 2px 0 #808080;
				min-width: 200px;
				min-height: 100px;
				resize: both;
				overflow: auto;
			}
			.titlebar {
				height: 20px;
				background: #c0c0c0;
				border-bottom: 1px solid #000;
				display: flex;
				align-items: center;
				padding: 0 5px;
				cursor: move;
			}
			.close-btn {
				width: 15px;
				height: 15px;
				background: #fff;
				border: 1px solid #000;
				margin-right: 5px;
				cursor: pointer;
			}
			.content {
				padding: 10px;
			}
			#startup-sound {
				display: none;
			}
			.dialog {
				position: fixed;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background: #e0e0e0;
				border: 1px solid #000;
				padding: 20px;
				text-align: center;
				z-index: 2000;
			}
			.hidden {
				display: none;
			}
			/* Cursor changes */
			body.drag {
				cursor: move;
			}
			body.resize {
				cursor: nwse-resize;
			}
			/* Animations */
			@keyframes fadeIn {
				from {
					opacity: 0;
				}
				to {
					opacity: 1;
				}
			}
			.window {
				animation: fadeIn 0.3s;
			}
		</style>
	</head>
	<body>
		<div id="menubar">
			<div
				class="menu"
				id="apple-menu"
			>
				ï£¿
			</div>
			<div
				class="menu"
				id="file-menu"
			>
				File
			</div>
			<div
				class="menu"
				id="edit-menu"
			>
				Edit
			</div>
			<div
				class="menu"
				id="view-menu"
			>
				View
			</div>
			<div
				class="menu"
				id="special-menu"
			>
				Special
			</div>
		</div>
		<div id="desktop">
			<!-- Desktop Icons -->
			<div
				class="icon"
				style="top: 10px; left: 10px"
				data-app="finder"
			>
				Finder
			</div>
			<div
				class="icon"
				style="top: 70px; left: 10px"
				data-app="calculator"
			>
				Calculator
			</div>
			<div
				class="icon"
				style="top: 130px; left: 10px"
				data-app="simpletext"
			>
				SimpleText
			</div>
			<div
				class="icon"
				style="top: 190px; left: 10px"
				data-app="about"
			>
				About This Mac
			</div>
			<div
				class="icon"
				style="top: 250px; left: 10px"
				data-app="controlpanel"
			>
				Control Panel
			</div>
			<div
				class="icon"
				style="top: 310px; left: 10px"
				data-app="clock"
			>
				Clock
			</div>
		</div>
		<!-- Dropdown Menus -->
		<div
			class="dropdown"
			id="apple-dropdown"
		>
			<div data-action="about">About This Mac...</div>
			<!-- Easter egg: Hidden item -->
			<div
				data-action="easter"
				style="display: none"
			>
				Secret
			</div>
		</div>
		<div
			class="dropdown"
			id="file-dropdown"
		>
			<div data-action="new">New Folder</div>
			<div data-action="open">Open</div>
			<div data-action="close">Close</div>
			<div data-action="quit">Quit</div>
		</div>
		<div
			class="dropdown"
			id="edit-dropdown"
		>
			<div data-action="undo">Undo</div>
			<div data-action="cut">Cut</div>
			<div data-action="copy">Copy</div>
			<div data-action="paste">Paste</div>
		</div>
		<div
			class="dropdown"
			id="view-dropdown"
		>
			<div data-action="icons">as Icons</div>
			<div data-action="list">as List</div>
		</div>
		<div
			class="dropdown"
			id="special-dropdown"
		>
			<div data-action="empty">Empty Trash</div>
			<div data-action="restart">Restart</div>
		</div>
		<!-- Startup Sound (base64 encoded simple chime) -->
		<audio
			id="startup-sound"
			autoplay
		>
			<source
				src="data:audio/wav;base64,UklGRl9vAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YeuNAA... (truncated for brevity; in real code, embed a full base64 WAV of Mac chime)"
				type="audio/wav"
			/>
		</audio>
		<!-- Dialog Template -->
		<div
			class="dialog hidden"
			id="error-dialog"
		>
			<p id="error-msg"></p>
			<button onclick="this.parentNode.classList.add('hidden')">OK</button>
		</div>
		<div
			class="dialog hidden"
			id="about-dialog"
		>
			<p>
				Mac OS System 7.5 Replica<br />Created by Perplexity AI<br />Memory:
				Simulated 8MB<br />CPU: Web Browser
			</p>
			<button onclick="this.parentNode.classList.add('hidden')">OK</button>
			<!-- Easter egg: Click 3 times for secret -->
		</div>

		<script>
			// Clean, modular JS structure
			const desktop = document.getElementById('desktop')
			let activeWindow = null
			let zIndex = 10
			let selectedIcon = null

			// Menu Handling
			const menus = {
				apple: document.getElementById('apple-menu'),
				file: document.getElementById('file-menu'),
				edit: document.getElementById('edit-menu'),
				view: document.getElementById('view-menu'),
				special: document.getElementById('special-menu'),
			}
			const dropdowns = {
				apple: document.getElementById('apple-dropdown'),
				file: document.getElementById('file-dropdown'),
				edit: document.getElementById('edit-dropdown'),
				view: document.getElementById('view-dropdown'),
				special: document.getElementById('special-dropdown'),
			}

			Object.keys(menus).forEach((key) => {
				menus[key].addEventListener('click', () =>
					toggleDropdown(dropdowns[key])
				)
			})

			function toggleDropdown(dd) {
				Object.values(dropdowns).forEach((d) => (d.style.display = 'none'))
				dd.style.display = dd.style.display === 'block' ? 'none' : 'block'
				dd.style.left = `${event.clientX}px`
			}

			// Dropdown Actions
			document.querySelectorAll('.dropdown div').forEach((item) => {
				item.addEventListener('click', () => {
					const action = item.dataset.action
					if (action === 'about') openAbout()
					if (action === 'quit') showError('Quitting... (Reload page)')
					if (action === 'restart') location.reload()
					// Add more actions as needed
					toggleDropdown(item.parentNode)
				})
			})

			// Icon Selection and Launch
			document.querySelectorAll('.icon').forEach((icon) => {
				icon.addEventListener('click', () => {
					if (selectedIcon) selectedIcon.classList.remove('selected')
					selectedIcon = icon
					icon.classList.add('selected')
				})
				icon.addEventListener('dblclick', () => launchApp(icon.dataset.app))
				makeDraggable(icon)
			})

			// Drag-and-Drop for Icons
			function makeDraggable(el) {
				let pos1 = 0,
					pos2 = 0,
					pos3 = 0,
					pos4 = 0
				el.onmousedown = dragMouseDown
				function dragMouseDown(e) {
					e.preventDefault()
					pos3 = e.clientX
					pos4 = e.clientY
					document.onmouseup = closeDrag
					document.onmousemove = elementDrag
					document.body.classList.add('drag')
				}
				function elementDrag(e) {
					e.preventDefault()
					pos1 = pos3 - e.clientX
					pos2 = pos4 - e.clientY
					pos3 = e.clientX
					pos4 = e.clientY
					el.style.top = el.offsetTop - pos2 + 'px'
					el.style.left = el.offsetLeft - pos1 + 'px'
				}
				function closeDrag() {
					document.onmouseup = null
					document.onmousemove = null
					document.body.classList.remove('drag')
				}
			}

			// Window Management
			function createWindow(title, content, appType) {
				const win = document.createElement('div')
				win.className = 'window'
				win.style.top = `${Math.random() * 200 + 50}px`
				win.style.left = `${Math.random() * 300 + 50}px`
				win.style.zIndex = zIndex++
				win.innerHTML = `
                <div class="titlebar">
                    <div class="close-btn" onclick="this.parentNode.parentNode.remove()"></div>
                    ${title}
                </div>
                <div class="content">${content}</div>
            `
				desktop.appendChild(win)
				makeDraggable(win.querySelector('.titlebar'))
				makeResizable(win)
				win.addEventListener('mousedown', () => {
					if (activeWindow) activeWindow.style.zIndex = zIndex - 1
					activeWindow = win
					win.style.zIndex = zIndex++
				})
				return win
			}

			function makeResizable(el) {
				el.onmousedown = (e) => {
					if (
						e.target === el &&
						e.offsetX > el.offsetWidth - 10 &&
						e.offsetY > el.offsetHeight - 10
					) {
						document.body.classList.add('resize')
						// Resize logic (simplified)
						// Implement full resize with mouse events here
					}
				}
			}

			// Launch Apps
			function launchApp(app) {
				let win
				switch (app) {
					case 'finder':
						win = createWindow(
							'Finder',
							'<div id="finder-content">Files: Folder1 | Folder2<br><button onclick="navigateFolder()">Open Folder</button></div>',
							'finder'
						)
						break
					case 'calculator':
						win = createWindow(
							'Calculator',
							'<input id="calc-display" value="0"><br><button onclick="calcBtn(1)">1</button><button onclick="calcBtn(2)">2</button>...<button onclick="calcOp(\'=\')">=</button>',
							'calc'
						)
						// Add full buttons in real code
						break
					case 'simpletext':
						win = createWindow(
							'SimpleText',
							'<textarea style="width:100%; height:100%;"></textarea>',
							'text'
						)
						break
					case 'about':
						openAbout()
						break
					case 'controlpanel':
						win = createWindow(
							'Control Panel',
							'Settings: Date/Time, Sound, etc.',
							'panel'
						)
						break
					case 'clock':
						win = createWindow(
							'Clock',
							'<div id="clock-display"></div>',
							'clock'
						)
						setInterval(
							() =>
								(document.getElementById('clock-display').innerText =
									new Date().toLocaleTimeString()),
							1000
						)
						break
				}
			}

			// Calculator Logic (simplified)
			let calcVal = '0',
				op = ''
			function calcBtn(num) {
				const display = document.getElementById('calc-display')
				display.value = display.value === '0' ? num : display.value + num
			}
			function calcOp(operator) {
				// Implement full calc logic here (e.g., +, -, *, /, =)
				if (operator === '=') {
					/* eval and display */
				}
			}

			// Finder Navigation (basic)
			function navigateFolder() {
				const content = document.getElementById('finder-content')
				content.innerHTML = 'Inside Folder: File1.txt | File2.txt'
			}

			// About Dialog
			function openAbout() {
				const dialog = document.getElementById('about-dialog')
				dialog.classList.remove('hidden')
				let clicks = 0
				dialog.addEventListener('click', () => {
					clicks++
					if (clicks === 3) showError('Easter Egg: Hello from 1996!')
				})
			}

			// Error Dialog
			function showError(msg) {
				const dialog = document.getElementById('error-dialog')
				document.getElementById('error-msg').innerText = msg
				dialog.classList.remove('hidden')
			}

			// Keyboard Shortcuts
			document.addEventListener('keydown', (e) => {
				if (e.metaKey && e.key === 'q') showError('Quitting...')
				// Add more (e.g., Cmd+O for open)
			})

			// Context Menu (right-click on desktop)
			desktop.addEventListener('contextmenu', (e) => {
				e.preventDefault()
				// Show custom context menu (implement as dropdown)
			})

			// Responsive: Adjust on resize
			window.addEventListener('resize', () => {
				// Scale elements if needed
			})

			// Simulate startup
			setTimeout(() => showError('Welcome to Mac OS 7.5 Replica!'), 1000)
		</script>
	</body>
</html>
